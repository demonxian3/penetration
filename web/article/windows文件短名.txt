windows系统下的文件长名和文件短名

1、短文件名的由来

windows下的文件短名是dos+fat12/fat16时代的产物，又称为8dot3命名法，类似于PROGRA~1（目录）或者元素周~1.exe（文件）这样的名称。

8是指文件名或目录名的主体部分小于等于8个字符 ;  3是指文件名或目录名的扩展部分小于等于3个字符 ;中间以 . 作为分割
 在FAT16文件系统中，由于FDT中的文件目录登记项只为文件名保留了8个字节，为扩展名保留了3个字节，所以DOS和Windows的用户为文件起名字时要受到8.3格式的限制。


2、长文件名由来

NTFS文件系统支持unicode（UTF16）字符集文件名，最长达255个UTF16字符，因此NTFS文件系统以及基于unicode字符集的32位NT内核Windows操作系统本身都没有必要遵循16位DOS时代遗留的8.3格式短文件名规范。

3、兼容性问题

从win95开始，采用fat32已经支持长文件名，但是为了保持兼容性，保证低版本的程序能正确读取长文件名文件，每当创建新文件或新目录时，系统自动为所有长文件名文件创建了一个对应的短文件名。使这个文件既可以用长文件名寻址，也可以用短文件名寻址。
当创建一个长文件名时，长名目录项和对应的别名（短名）目录项的存储有以下6个处理原则：
・取长文件名的前6个字符加上“～1”形成长文件名的别名（即短文件名），并将长文件名中最后一部分（最后一个间隔符“.”后面字符）的前3个字符作为其扩展名。
・如果已存在这个名字的文件，则符号“～”后的数字会自动增加。
・任何包括小写字母的文件名都被看作是长文件名，而不管其长度是多少。如果有对于DOS和Windows3.x非法的字符，则用下划线替代。
・长文件名存储在属性标志为OFH的32字节目录登记项中（这是与短文件名目录项的区别）。用Unicode格式编码，每个字符（无论是英文或是汉字）均占2字节。
・每个目录登记项用26个字节存储13个字符（序号由第1字节指定）。位置多余时，先用00表示结束，再用FFH填充。
・长文件名用若干个长名目录项保存，长文件名目录项倒序排在文件短目录项前面。
采用以上的存储办法后，在Windows9x下创建的长文件名在DOS或Windows3.x下就只能看见其对应的短文件名，完全忽略了长文件名。在Windows9x下运行的应用程序通过操作系统请求文件名时，Windows9x会根据应用程序的性质分别给予不同的文件名，16位应用程序得到8.3格式的文件名，而32位应用程序得到长文件名。

win9x系统同样支持长文件名，同时强制生成一个短文件名。
在nt32+ntfs下面短文件名变为可选。

在xp和win7系统下，在命令行中与短文件名有关的一些命令：
fsutil behavior query disable8dot3    检查NTFS驱动是否开启8.3兼容特性

fsutil behavior set disable8dot3 1    关闭8.3兼容特性

fsutil behavior set disable8dot3 0    开启8.3兼容特性

fsutil file setshortname <longname> <8.3name>  手工指定一个8.3短名称

dir /x   列出当前目录的子目录和文件，以及相应的8.3兼容名称（如果有的话）